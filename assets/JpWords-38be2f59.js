var Ne=Object.defineProperty;var We=(s,e,n)=>e in s?Ne(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var re=(s,e,n)=>(We(s,typeof e!="symbol"?e+"":e,n),n);import{S as _e,i as me,s as be,K as te,L as N,M as ae,N as W,f as w,j as Be,O as Y,P as Ce,J as R,Q as J,R as je,I as M,m as k,o as ne,p as Ie,q as fe,a as $,v as de,x as ye,E as Oe,F as Re,G as Me,H as Pe,T as pe,e as A,b as K,c as P,Z as v,g as S,_ as F,u as Je,$ as he}from"./index-911ad0d2.js";import{C as ce}from"./ActionIcons-954ce75e.js";import{c as se,f as Ae,S as oe,R as we,d as Ke}from"./classAdderBuilder-1c792b72.js";function qe(s){let e;const n=s[10].default,o=Oe(n,s,s[12],null);return{c(){o&&o.c()},m(r,l){o&&o.m(r,l),e=!0},p(r,l){o&&o.p&&(!e||l&4096)&&Re(o,n,r,r[12],e?Pe(n,r[12],l,null):Me(r[12]),null)},i(r){e||(M(o,r),e=!0)},o(r){R(o,r),e=!1},d(r){o&&o.d(r)}}}function Te(s){let e,n,o;const r=[{tag:s[3]},{use:[s[5],...s[0]]},{class:se({[s[1]]:!0,"mdc-button__label":s[6]==="button","mdc-fab__label":s[6]==="fab","mdc-tab__text-label":s[6]==="tab","mdc-image-list__label":s[6]==="image-list","mdc-snackbar__label":s[6]==="snackbar","mdc-banner__text":s[6]==="banner","mdc-segmented-button__label":s[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":s[6]==="data-table:pagination","mdc-data-table__header-cell-label":s[6]==="data-table:sortable-header-cell"})},s[6]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:s[7]},s[8]];var l=s[2];function c(t){let a={$$slots:{default:[qe]},$$scope:{ctx:t}};for(let i=0;i<r.length;i+=1)a=$(a,r[i]);return{props:a}}return l&&(e=te(l,c(s)),s[11](e)),{c(){e&&N(e.$$.fragment),n=ae()},m(t,a){e&&W(e,t,a),w(t,n,a),o=!0},p(t,[a]){const i=a&491?Be(r,[a&8&&{tag:t[3]},a&33&&{use:[t[5],...t[0]]},a&66&&{class:se({[t[1]]:!0,"mdc-button__label":t[6]==="button","mdc-fab__label":t[6]==="fab","mdc-tab__text-label":t[6]==="tab","mdc-image-list__label":t[6]==="image-list","mdc-snackbar__label":t[6]==="snackbar","mdc-banner__text":t[6]==="banner","mdc-segmented-button__label":t[6]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":t[6]==="data-table:pagination","mdc-data-table__header-cell-label":t[6]==="data-table:sortable-header-cell"})},a&64&&Y(t[6]==="snackbar"?{"aria-atomic":"false"}:{}),a&128&&{tabindex:t[7]},a&256&&Y(t[8])]):{};if(a&4096&&(i.$$scope={dirty:a,ctx:t}),a&4&&l!==(l=t[2])){if(e){Ce();const u=e;R(u.$$.fragment,1,0,()=>{J(u,1)}),je()}l?(e=te(l,c(t)),t[11](e),N(e.$$.fragment),M(e.$$.fragment,1),W(e,n.parentNode,n)):e=null}else l&&e.$set(i)},i(t){o||(e&&M(e.$$.fragment,t),o=!0)},o(t){e&&R(e.$$.fragment,t),o=!1},d(t){s[11](null),t&&k(n),e&&J(e,t)}}}function Ue(s,e,n){const o=["use","class","component","tag","getElement"];let r=ne(e,o),{$$slots:l={},$$scope:c}=e;const t=Ae(Ie());let{use:a=[]}=e,{class:i=""}=e,u,{component:_=oe}=e,{tag:g=_===oe?"span":void 0}=e;const C=fe("SMUI:label:context"),E=fe("SMUI:label:tabindex");function B(){return u.getElement()}function p(d){ye[d?"unshift":"push"](()=>{u=d,n(4,u)})}return s.$$set=d=>{e=$($({},e),de(d)),n(8,r=ne(e,o)),"use"in d&&n(0,a=d.use),"class"in d&&n(1,i=d.class),"component"in d&&n(2,_=d.component),"tag"in d&&n(3,g=d.tag),"$$scope"in d&&n(12,c=d.$$scope)},[a,i,_,g,u,t,C,E,r,B,l,p,c]}class ge extends _e{constructor(e){super(),me(this,e,Ue,Te,be,{use:0,class:1,component:2,tag:3,getElement:9})}get getElement(){return this.$$.ctx[9]}}function ke(s){let e;return{c(){e=A("div"),P(e,"class","mdc-button__touch")},m(n,o){w(n,e,o)},d(n){n&&k(e)}}}function Le(s){let e,n,o,r;const l=s[28].default,c=Oe(l,s,s[30],null);let t=s[6]&&ke();return{c(){e=A("div"),n=K(),c&&c.c(),t&&t.c(),o=ae(),P(e,"class","mdc-button__ripple")},m(a,i){w(a,e,i),w(a,n,i),c&&c.m(a,i),t&&t.m(a,i),w(a,o,i),r=!0},p(a,i){c&&c.p&&(!r||i[0]&1073741824)&&Re(c,l,a,a[30],r?Pe(l,a[30],i,null):Me(a[30]),null),a[6]?t||(t=ke(),t.c(),t.m(o.parentNode,o)):t&&(t.d(1),t=null)},i(a){r||(M(c,a),r=!0)},o(a){R(c,a),r=!1},d(a){a&&k(e),a&&k(n),c&&c.d(a),t&&t.d(a),a&&k(o)}}}function Fe(s){let e,n,o;const r=[{tag:s[10]},{use:[[we,{ripple:s[3],unbounded:!1,color:s[4],disabled:!!s[23].disabled,addClass:s[19],removeClass:s[20],addStyle:s[21]}],s[17],...s[0]]},{class:se({[s[1]]:!0,"mdc-button":!0,"mdc-button--raised":s[5]==="raised","mdc-button--unelevated":s[5]==="unelevated","mdc-button--outlined":s[5]==="outlined","smui-button--color-secondary":s[4]==="secondary","mdc-button--touch":s[6],"mdc-card__action":s[18]==="card:action","mdc-card__action--button":s[18]==="card:action","mdc-dialog__button":s[18]==="dialog:action","mdc-top-app-bar__navigation-icon":s[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":s[18]==="top-app-bar:action","mdc-snackbar__action":s[18]==="snackbar:actions","mdc-banner__secondary-action":s[18]==="banner"&&s[8],"mdc-banner__primary-action":s[18]==="banner"&&!s[8],"mdc-tooltip__action":s[18]==="tooltip:rich-actions",...s[12]})},{style:Object.entries(s[13]).map(Se).concat([s[2]]).join(" ")},s[16],s[15],s[14],{href:s[7]},s[23]];var l=s[9];function c(t){let a={$$slots:{default:[Le]},$$scope:{ctx:t}};for(let i=0;i<r.length;i+=1)a=$(a,r[i]);return{props:a}}return l&&(e=te(l,c(s)),s[29](e),e.$on("click",s[22])),{c(){e&&N(e.$$.fragment),n=ae()},m(t,a){e&&W(e,t,a),w(t,n,a),o=!0},p(t,a){const i=a[0]&12580351?Be(r,[a[0]&1024&&{tag:t[10]},a[0]&12189721&&{use:[[we,{ripple:t[3],unbounded:!1,color:t[4],disabled:!!t[23].disabled,addClass:t[19],removeClass:t[20],addStyle:t[21]}],t[17],...t[0]]},a[0]&266610&&{class:se({[t[1]]:!0,"mdc-button":!0,"mdc-button--raised":t[5]==="raised","mdc-button--unelevated":t[5]==="unelevated","mdc-button--outlined":t[5]==="outlined","smui-button--color-secondary":t[4]==="secondary","mdc-button--touch":t[6],"mdc-card__action":t[18]==="card:action","mdc-card__action--button":t[18]==="card:action","mdc-dialog__button":t[18]==="dialog:action","mdc-top-app-bar__navigation-icon":t[18]==="top-app-bar:navigation","mdc-top-app-bar__action-item":t[18]==="top-app-bar:action","mdc-snackbar__action":t[18]==="snackbar:actions","mdc-banner__secondary-action":t[18]==="banner"&&t[8],"mdc-banner__primary-action":t[18]==="banner"&&!t[8],"mdc-tooltip__action":t[18]==="tooltip:rich-actions",...t[12]})},a[0]&8196&&{style:Object.entries(t[13]).map(Se).concat([t[2]]).join(" ")},a[0]&65536&&Y(t[16]),a[0]&32768&&Y(t[15]),a[0]&16384&&Y(t[14]),a[0]&128&&{href:t[7]},a[0]&8388608&&Y(t[23])]):{};if(a[0]&1073741888&&(i.$$scope={dirty:a,ctx:t}),a[0]&512&&l!==(l=t[9])){if(e){Ce();const u=e;R(u.$$.fragment,1,0,()=>{J(u,1)}),je()}l?(e=te(l,c(t)),t[29](e),e.$on("click",t[22]),N(e.$$.fragment),M(e.$$.fragment,1),W(e,n.parentNode,n)):e=null}else l&&e.$set(i)},i(t){o||(e&&M(e.$$.fragment,t),o=!0)},o(t){e&&R(e.$$.fragment,t),o=!1},d(t){s[29](null),t&&k(n),e&&J(e,t)}}}const Se=([s,e])=>`${s}: ${e};`;function Xe(s,e,n){let o,r,l;const c=["use","class","style","ripple","color","variant","touch","href","action","defaultAction","secondary","component","tag","getElement"];let t=ne(e,c),{$$slots:a={},$$scope:i}=e;const u=Ae(Ie());let{use:_=[]}=e,{class:g=""}=e,{style:C=""}=e,{ripple:E=!0}=e,{color:B="primary"}=e,{variant:p="text"}=e,{touch:d=!1}=e,{href:X=void 0}=e,{action:y="close"}=e,{defaultAction:q=!1}=e,{secondary:m=!1}=e,h,O={},U={},L=fe("SMUI:button:context"),{component:Z=oe}=e,{tag:z=Z===oe?X==null?"button":"a":void 0}=e,b=t.disabled;pe("SMUI:label:context","button"),pe("SMUI:icon:context","button");function D(f){O[f]||n(12,O[f]=!0,O)}function j(f){(!(f in O)||O[f])&&n(12,O[f]=!1,O)}function I(f,ee){U[f]!=ee&&(ee===""||ee==null?(delete U[f],n(13,U)):n(13,U[f]=ee,U))}function le(){L==="banner"&&Ke(x(),m?"SMUIBannerButton:secondaryActionClick":"SMUIBannerButton:primaryActionClick")}function x(){return h.getElement()}function V(f){ye[f?"unshift":"push"](()=>{h=f,n(11,h)})}return s.$$set=f=>{n(31,e=$($({},e),de(f))),n(23,t=ne(e,c)),"use"in f&&n(0,_=f.use),"class"in f&&n(1,g=f.class),"style"in f&&n(2,C=f.style),"ripple"in f&&n(3,E=f.ripple),"color"in f&&n(4,B=f.color),"variant"in f&&n(5,p=f.variant),"touch"in f&&n(6,d=f.touch),"href"in f&&n(7,X=f.href),"action"in f&&n(24,y=f.action),"defaultAction"in f&&n(25,q=f.defaultAction),"secondary"in f&&n(8,m=f.secondary),"component"in f&&n(9,Z=f.component),"tag"in f&&n(10,z=f.tag),"$$scope"in f&&n(30,i=f.$$scope)},s.$$.update=()=>{if(n(16,o=L==="dialog:action"&&y!=null?{"data-mdc-dialog-action":y}:{action:e.action}),n(15,r=L==="dialog:action"&&q?{"data-mdc-dialog-button-default":""}:{default:e.default}),n(14,l=L==="banner"?{}:{secondary:e.secondary}),b!==t.disabled){const f=x();"blur"in f&&f.blur(),n(27,b=t.disabled)}},e=de(e),[_,g,C,E,B,p,d,X,m,Z,z,h,O,U,l,r,o,u,L,D,j,I,le,t,y,q,x,b,a,V,i]}class ie extends _e{constructor(e){super(),me(this,e,Xe,Fe,be,{use:0,class:1,style:2,ripple:3,color:4,variant:5,touch:6,href:7,action:24,defaultAction:25,secondary:8,component:9,tag:10,getElement:26},null,[-1,-1])}get getElement(){return this.$$.ctx[26]}}const Ve="./nijigen/version_map.json",Ge="./nijigen/words.json";async function De(s){return(await fetch(s)).json()}class He{constructor(e){re(this,"db");re(this,"dbName");this.dbName=e,this.db=null}openStore(e,n,o){return new Promise((r,l)=>{const c=window.indexedDB.open(this.dbName,6);c.onsuccess=t=>{this.db=t.target.result,r(this.db)},c.onerror=t=>{l(t)},c.onupgradeneeded=t=>{const i=t.target.result.createObjectStore(e,{keyPath:n});Array.isArray(o)&&o.forEach(u=>{i.createIndex(u.key,u.key,{unique:u.unique})}),i.transaction.oncomplete=()=>{console.log("创建仓库成功")},console.log("更新成功"),console.log(t)}})}add(e,n){return new Promise((o,r)=>{const l=this.db.transaction([e],"readwrite").objectStore(e);let c=0,t=0;const a={onsuccess:u=>{++t>=c&&o({code:0,data:{total:c}})},onerror:u=>{r({code:1,message:u})}};let i;Array.isArray(n)?n.forEach(u=>{Array.isArray(u)?u.forEach(_=>{c++,i=l.put(_),i.onsuccess=a.onsuccess,i.onerror=a.onerror}):(i=l.put(u),i.onsuccess=a.onsuccess,i.onerror=a.onerror)}):(i=l.put(n),i.onsuccess=a.onsuccess,i.onerror=a.onerror)})}delete(e,n){return new Promise((o,r)=>{const l=this.db.transaction([e],"readwrite").objectStore(e).delete(n);l.onsuccess=()=>{o({code:0})},l.onerror=c=>{r({code:1,message:c})}})}getAllList(e){return new Promise((n,o)=>{const r=this.db.transaction([e]).objectStore(e).getAll();r.onsuccess=l=>{n(l.target.result)},r.onerror=l=>{o({code:1,message:l})}})}getItem(e,n){return new Promise((o,r)=>{const l=this.db.transaction([e]).objectStore(e).get(n);l.onsuccess=c=>{c.target.result?o({code:0,data:c.target.result}):o({code:1,data:c.target.result})},l.onerror=c=>{r({code:1,message:c})}})}async count(e,n){return new Promise((o,r)=>{const l=this.db.transaction([e],"readonly").objectStore(e);let c=l.count();n?c=l.index(n.key).count(n.range):c=l.count(),c.onsuccess=()=>{o(c.result)},c.onerror=t=>{r(t)}})}createCursor(e,n="",o){const r=this.db.transaction([e],"readonly").objectStore(e);let l;return n?l=r.index(n).openCursor(o):l=r.openKeyCursor(o),l}}const Qe="mahiru",T="js_word",G="has_study",H="not_study",Q="not_good",Ze=[{key:H,unique:!1},{key:G,unique:!1},{key:Q,unique:!1}],ue="word_version";function ze(s){let e,n,o,r,l,c,t,a,i,u,_,g,C,E,B;return{c(){e=A("div"),n=v("总词汇量："),o=v(s[0]),r=K(),l=A("div"),c=v("未学习："),t=v(s[1]),a=K(),i=A("div"),u=v("已学会："),_=v(s[2]),g=K(),C=A("div"),E=v("不熟悉："),B=v(s[3]),P(e,"class","summary-item svelte-x7nw2t"),P(l,"class","summary-item svelte-x7nw2t"),P(i,"class","summary-item svelte-x7nw2t"),P(C,"class","summary-item svelte-x7nw2t")},m(p,d){w(p,e,d),S(e,n),S(e,o),w(p,r,d),w(p,l,d),S(l,c),S(l,t),w(p,a,d),w(p,i,d),S(i,u),S(i,_),w(p,g,d),w(p,C,d),S(C,E),S(C,B)},p(p,d){d&1&&F(o,p[0]),d&2&&F(t,p[1]),d&4&&F(_,p[2]),d&8&&F(B,p[3])},d(p){p&&k(e),p&&k(r),p&&k(l),p&&k(a),p&&k(i),p&&k(g),p&&k(C)}}}function Ye(s){let e,n,o;return{c(){e=v("学习进度："),n=v(s[4]),o=v("%")},m(r,l){w(r,e,l),w(r,n,l),w(r,o,l)},p(r,l){l&16&&F(n,r[4])},d(r){r&&k(e),r&&k(n),r&&k(o)}}}function ve(s){let e,n,o,r=s[6].desc+"",l,c=s[6].read&&Ee(s);return{c(){c&&c.c(),e=K(),n=A("div"),o=v("翻译："),l=v(r),P(n,"class","desc svelte-x7nw2t")},m(t,a){c&&c.m(t,a),w(t,e,a),w(t,n,a),S(n,o),S(n,l)},p(t,a){t[6].read?c?c.p(t,a):(c=Ee(t),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),a&64&&r!==(r=t[6].desc+"")&&F(l,r)},d(t){c&&c.d(t),t&&k(e),t&&k(n)}}}function Ee(s){let e,n,o=s[6].read+"",r;return{c(){e=A("div"),n=v("读法："),r=v(o),P(e,"class","read svelte-x7nw2t")},m(l,c){w(l,e,c),S(e,n),S(e,r)},p(l,c){c&64&&o!==(o=l[6].read+"")&&F(r,o)},d(l){l&&k(e)}}}function $e(s){let e,n=s[6].word+"",o,r,l,c,t,a,i,u=s[9]&&ve(s);return{c(){e=A("div"),o=v(n),r=K(),l=A("span"),c=v(s[7]),a=K(),u&&u.c(),i=ae(),P(l,"class",t=he(`tag jpw_tag-${s[8]}`)+" svelte-x7nw2t"),P(e,"class","word svelte-x7nw2t")},m(_,g){w(_,e,g),S(e,o),S(e,r),S(e,l),S(l,c),w(_,a,g),u&&u.m(_,g),w(_,i,g)},p(_,g){g&64&&n!==(n=_[6].word+"")&&F(o,n),g&128&&F(c,_[7]),g&256&&t!==(t=he(`tag jpw_tag-${_[8]}`)+" svelte-x7nw2t")&&P(l,"class",t),_[9]?u?u.p(_,g):(u=ve(_),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null)},d(_){_&&k(e),_&&k(a),u&&u.d(_),_&&k(i)}}}function xe(s){let e;return{c(){e=v("展示")},m(n,o){w(n,e,o)},d(n){n&&k(e)}}}function et(s){let e,n;return e=new ge({props:{$$slots:{default:[xe]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment)},m(o,r){W(e,o,r),n=!0},p(o,r){const l={};r&67108864&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){R(e.$$.fragment,o),n=!1},d(o){J(e,o)}}}function tt(s){let e;return{c(){e=v("掌握")},m(n,o){w(n,e,o)},d(n){n&&k(e)}}}function nt(s){let e,n;return e=new ge({props:{$$slots:{default:[tt]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment)},m(o,r){W(e,o,r),n=!0},p(o,r){const l={};r&67108864&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){R(e.$$.fragment,o),n=!1},d(o){J(e,o)}}}function st(s){let e;return{c(){e=v("未掌握")},m(n,o){w(n,e,o)},d(n){n&&k(e)}}}function ot(s){let e,n;return e=new ge({props:{$$slots:{default:[st]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment)},m(o,r){W(e,o,r),n=!0},p(o,r){const l={};r&67108864&&(l.$$scope={dirty:r,ctx:o}),e.$set(l)},i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){R(e.$$.fragment,o),n=!1},d(o){J(e,o)}}}function at(s){let e,n,o,r,l,c,t,a,i,u,_,g,C,E,B,p,d,X,y,q;return a=new ce({props:{class:"jpw_summary",variant:"outlined",padded:!0,$$slots:{default:[ze]},$$scope:{ctx:s}}}),u=new ce({props:{class:"jpw_process",variant:"outlined",padded:!0,$$slots:{default:[Ye]},$$scope:{ctx:s}}}),g=new ce({props:{class:"jpw_word-container",padded:!0,$$slots:{default:[$e]},$$scope:{ctx:s}}}),B=new ie({props:{variant:"raised",class:"jpw_btn-show",$$slots:{default:[et]},$$scope:{ctx:s}}}),B.$on("click",s[10]),d=new ie({props:{variant:"raised",class:"jpw_btn-ok",$$slots:{default:[nt]},$$scope:{ctx:s}}}),d.$on("click",s[12]),y=new ie({props:{variant:"raised",class:"jpw_btn-not",$$slots:{default:[ot]},$$scope:{ctx:s}}}),y.$on("click",s[13]),{c(){e=A("div"),n=v(`背词小工具
  `),o=A("span"),r=v("版本："),l=v(s[5]),c=K(),t=A("div"),N(a.$$.fragment),i=K(),N(u.$$.fragment),_=K(),N(g.$$.fragment),C=K(),E=A("div"),N(B.$$.fragment),p=K(),N(d.$$.fragment),X=K(),N(y.$$.fragment),P(o,"class","version svelte-x7nw2t"),P(e,"class","title svelte-x7nw2t"),P(E,"class","btn-group svelte-x7nw2t"),P(t,"class","container svelte-x7nw2t")},m(m,h){w(m,e,h),S(e,n),S(e,o),S(o,r),S(o,l),w(m,c,h),w(m,t,h),W(a,t,null),S(t,i),W(u,t,null),S(t,_),W(g,t,null),S(t,C),S(t,E),W(B,E,null),S(E,p),W(d,E,null),S(E,X),W(y,E,null),q=!0},p(m,[h]){(!q||h&32)&&F(l,m[5]);const O={};h&67108879&&(O.$$scope={dirty:h,ctx:m}),a.$set(O);const U={};h&67108880&&(U.$$scope={dirty:h,ctx:m}),u.$set(U);const L={};h&67109824&&(L.$$scope={dirty:h,ctx:m}),g.$set(L);const Z={};h&67108864&&(Z.$$scope={dirty:h,ctx:m}),B.$set(Z);const z={};h&67108864&&(z.$$scope={dirty:h,ctx:m}),d.$set(z);const b={};h&67108864&&(b.$$scope={dirty:h,ctx:m}),y.$set(b)},i(m){q||(M(a.$$.fragment,m),M(u.$$.fragment,m),M(g.$$.fragment,m),M(B.$$.fragment,m),M(d.$$.fragment,m),M(y.$$.fragment,m),q=!0)},o(m){R(a.$$.fragment,m),R(u.$$.fragment,m),R(g.$$.fragment,m),R(B.$$.fragment,m),R(d.$$.fragment,m),R(y.$$.fragment,m),q=!1},d(m){m&&k(e),m&&k(c),m&&k(t),J(a),J(u),J(g),J(B),J(d),J(y)}}}function lt(s,e,n){let o=0,r=0,l=0,c=0,t="0.00",a=null,i,u="0.0.0",_={word:"",desc:"",read:""},g="",C=0,E=!1;const B=()=>{n(9,E=!0)},p=async b=>{if(!E){B();return}n(9,E=!1);let D=_[Q]||0,j=_[G];b?D>0&&D--:D++;const I={..._,[H]:0,[G]:j||b?1:0,[Q]:D};await i.add(T,I),m(),d()},d=()=>{const b=Math.random();b<.1?h(1,IDBKeyRange.lowerBound(1),Math.ceil(Math.random()*l)):b<.3?h(2,IDBKeyRange.lowerBound(3),Math.ceil(Math.random()*c)):h(0,IDBKeyRange.lowerBound(1),Math.ceil(Math.random()*r))};async function X(){const b=await De(Ve),D=localStorage.getItem(ue),j=b.findIndex(I=>I===D);return b.slice(j+1)}async function y(b){a||(a=await De(Ge));const D=[],{word:j,read:I,desc:le}=a[b],x=j.length;for(let V=0;V<x;V++)D.push({[T]:j[V],word:j[V],read:I[V],desc:le[V],[H]:1});return D}async function q(b){if(i=new He(Qe),await i.openStore(T,T,Ze),b){const{code:D}=await i.add(T,b);D===0&&localStorage.setItem(ue,u)}L()}const m=async()=>{n(0,o=await i.count(T)),n(1,r=await i.count(T,{key:H,range:IDBKeyRange.lowerBound(1)})),n(2,l=await i.count(T,{key:G,range:IDBKeyRange.lowerBound(1)})),n(3,c=await i.count(T,{key:Q,range:IDBKeyRange.lowerBound(3,!0)})),n(4,t=(l/o*100).toFixed(2))},h=(b=0,D,j=0)=>{if(b===0){const I=i.createCursor(T,H,D);I.onsuccess=O(H,j)}if(b===1){const I=i.createCursor(T,G,D);I.onsuccess=O(G,j)}if(b===2){const I=i.createCursor(T,Q,D);I.onsuccess=O(Q,j)}},O=(b,D)=>j=>{const I=j.target.result;if(!I){switch(b){case H:h(2);break;case G:h(0);break;case Q:h(1);break}return}if(D>0){I.advance(D),D=0;return}switch(n(6,_=I.value||{}),b){case H:n(7,g="新"),n(8,C=0);break;case G:n(7,g="已掌握"),n(8,C=1);break;case Q:n(7,g="不熟悉"),n(8,C=2);break}};async function U(){const b=await X();if(b.length===0){n(5,u=localStorage.getItem(ue)),q();return}const D=[];for(let j=0;j<b.length;j++)D.push(await y(b[j]));n(5,u=b[b.length-1]),a=null,q(D)}async function L(){await m(),d()}return Je(U),[o,r,l,c,t,u,_,g,C,E,B,p,()=>p(!0),()=>p(!1)]}class ft extends _e{constructor(e){super(),me(this,e,lt,at,be,{})}}export{ft as default};
