# redis雪崩，击穿，穿透

## 雪崩
在高并发情况下，大量redis key在同一时间失效，大量请求直接落在数据库上，导致数据库宕机。

### 解决方案
- 随机设置key失效时间，避免大量key集体失效
`setRedis(Key, value, time + Math.random() * 10000）`
- 跑定时任务，在缓存失效前刷进新的缓存
- 不设置过期时间

## 穿透
redis缓存和数据库中没有相关数据(例用户直接携带id<=0的参数不断发起请求)，redis中没有这样的数据，无法进行拦截，直接被穿透到数据库，导致数据库压力过大宕机。

### 解决方案
- 对不存在的数据缓存到redis中，设置key，value值为null(不管是数据为null还是系统bug问题)，并设置一个短期过期时间段，避免过期时间过长影响正常用户使用。
- 拉黑IP
- 参数校验，拦截不合法参数
- 布隆过滤器

## 击穿
某一个热点key，在不停地扛着高并发，当这个热点key在失效的一瞬间，持续的高并发访问就击破缓存直接访问数据库，导致数据库宕机。

### 解决方案
- 不设置过期时间
- 互斥锁
